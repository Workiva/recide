<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>recide.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Recide</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>recide</span></div></div></li><li class="depth-2 branch current"><a href="recide.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="recide.error.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error</span></div></a></li><li class="depth-2 branch"><a href="recide.fressian.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fressian</span></div></a></li><li class="depth-2 branch"><a href="recide.impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></a></li><li class="depth-2"><a href="recide.sanex.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sanex</span></div></a></li><li class="depth-3"><a href="recide.sanex.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-2"><a href="recide.utils.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="recide.core.html#var-assoc-error"><div class="inner"><span>assoc-error</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-deferror"><div class="inner"><span>deferror</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-deferror-group"><div class="inner"><span>deferror-group</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error"><div class="inner"><span>error</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-.3Eform"><div class="inner"><span>error-&gt;form</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-.3Emap"><div class="inner"><span>error-&gt;map</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-form"><div class="inner"><span>error-form</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-map"><div class="inner"><span>error-map</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-map-.3Eform"><div class="inner"><span>error-map-&gt;form</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-map-.3Ethrowable"><div class="inner"><span>error-map-&gt;throwable</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-map.3F"><div class="inner"><span>error-map?</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error-type"><div class="inner"><span>error-type</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-error.3F"><div class="inner"><span>error?</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-generate-library.21"><div class="inner"><span>generate-library!</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-insist"><div class="inner"><span>insist</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-make-tag-.3Eerror-form"><div class="inner"><span>make-tag-&gt;error-form</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-raise"><div class="inner"><span>raise</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-throwable-.3Eerror-map"><div class="inner"><span>throwable-&gt;error-map</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-try*"><div class="inner"><span>try*</span></div></a></li><li class="depth-1"><a href="recide.core.html#var-update-error"><div class="inner"><span>update-error</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">recide.core</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-assoc-error"><h3>assoc-error</h3><div class="usage"><code>(assoc-error x k v)</code></div><div class="doc"><div class="markdown"><p>Given a recide error, this returns a copy with [k v] assoc’ed into its ex-data.</p></div></div></div><div class="public anchor" id="var-deferror"><h3>deferror</h3><h4 class="type">macro</h4><div class="usage"><code>(deferror error-name type generic-str)</code><code>(deferror error-name type generic-str required-keys)</code></div><div class="doc"><div class="markdown"><p>Defines specialized versions of the recide.core/error and recide.core/raise macros, where the type and the ‘generic’ portion of the error message are static and required data are specified via the final sequence of keywords. Defines two macros (for compile-time errors). The first is a specialized constructor interned as <code>&lt;error-name&gt;</code>, analogous to recide.core/error, with the following signature: ([detail-msg data] [detail-msg data cause])</p>
<p>Also defined is a corresponding <code>raise-&lt;error-name&gt;</code> macro with the signature: ([detail-msg {:as extra-data}]
 [detail-msg {:as extra-data} cause])</p>
<p>Example: (deferror io-timeout  :io/timeout  “A network operation timed out”  [:operation])</p>
<p>Use the defined constructor like so: (io-timeout “the gremlins endpoint failed to respond.”  {:operation ’gremlin-endpoint,  :other-info :kazzam})</p>
<p>This will construct a recide error of the following form: {:recide/type :io/timeout  :recide/msg “A network operation timed out: the gremlins endpoint failed to respond.”  :recide/data {:operation ’gremlin-endpoint, :other-info :kazzam}  :recide.serialized-throwable/v1 <serialized-form>}</serialized-form></p>
<p>Using the generated raise-* macro is similar: (raise-io-timeout “the gremlins endpoint failed to respond.”  {:operation ’gremlin-endpoint,  :other-info :kazzam}</p>
<p>In both macros, if :operation is left out of the data map, an exception will be thrown at compile-time because it was marked as required in <code>deferror</code>.</p>
<p>Uses ErrorForm: recide.impl/default-error-definition</p></div></div></div><div class="public anchor" id="var-deferror-group"><h3>deferror-group</h3><h4 class="type">macro</h4><div class="usage"><code>(deferror-group error-name namespace-key &amp; subtypes)</code></div><div class="doc"><div class="markdown"><p>Defines new specialized versions of the recide.core/error and recide.core/raise macros, for working with a namespaced family of error types. For each subtype, the ‘generic’ portion of the error message is static. Required data keywords can be specified both for the entire family of errors and for each subtype.</p>
<p>Both the constructor and raise-* macros have the same signature: ([detail-msg {:as extra-data}]
 [detail-msg {:as extra-data} cause])</p>
<p>Example: (deferror-group io-failure  (:io.failure [:operation])  (timeout “A network operation timed out” [:timeout-ms])  (connection-reset “The other node reset the connection.”)</p>
<p>An example of using the defined constructor is: (io-failure :timeout  “the gremlins endpoint failed to respond.”  {:operation ’gremlin-endpoint,  :timeout-ms 10000})</p>
<p>This will construct a recide error of the following form: {:recide/type :io.failure/timeout  :recide/msg “A network operation timed out: the gremlins endpoint failed to respond.”  :recide/data {:operation ’gremlin-endpoint, :timeout-ms 10000}  :recide.serialized-throwable/v1 <serialized-form>}</serialized-form></p>
<p>The generated raise-* macro uses the exact same syntax, but throws the constructed exception.</p>
<p>In both macros, a compile-time exception will be thrown if either :operation or :timeout-ms is left out of the data-map for :io.failure/timeout, because the entire family of errors requires :operation and the :timeout error in particular requires :timeout-ms.</p>
<p>Uses ErrorForm: recide.impl/default-error-definition</p></div></div></div><div class="public anchor" id="var-error"><h3>error</h3><div class="usage"><code>(error type msg data)</code><code>(error type msg data cause)</code></div><div class="doc"><div class="markdown"><p>Returns a recide error (IExceptionInfo) with the type (keyword), msg (string), data (map), and cause (Throwable). Merges the following map onto the ex-data:</p>
<p>{:recide/error <a href="mailto:recide.error.ErrorForm@447521e">recide.error.ErrorForm@447521e</a>,  :recide/type type}</p>
<p>ErrorForm definition: recide.impl/default-error-definition Constructor: clojure.core$ex_info</p></div></div></div><div class="public anchor" id="var-error-.3Eform"><h3>error-&gt;form</h3><div class="usage"><code>(error-&gt;form x)</code></div><div class="doc"><div class="markdown"><p>If x is a recide error, returns the ErrorForm defining its construction.</p></div></div></div><div class="public anchor" id="var-error-.3Emap"><h3>error-&gt;map</h3><div class="usage"><code>(error-&gt;map x)</code></div><div class="doc"><div class="markdown"><p>Verifies that the IExceptionInfo is a recide error, then converts it to map form.</p></div></div></div><div class="public anchor" id="var-error-form"><h3>error-form</h3><div class="usage"><code>(error-form {:keys [serialization-tag type-keyword message-keyword data-keyword cause-keyword serialized-keyword constructor metadata-fns], :or {serialization-tag "recide/error", type-keyword :recide/type, message-keyword :recide/msg, data-keyword :recide/data, cause-keyword :recide/cause, serialized-keyword :recide.serialized-throwable/v1, constructor ex-info, metadata-fns {}}})</code></div><div class="doc"><div class="markdown"><p>Constructor for recide.error/ErrorForm. Values not supplied in the map here will default to the same behavior as recide.core errors. All available keys illustrated here with return values corresponding to recide defaults:</p>
<pre><code>(error-form
   {:serialization-tag "recide/error"
    :type-keyword :recide/type
    :message-keyword :recide/msg
    :data-keyword :recide/data
    :cause-keyword :recide/cause
    :serialized-keyword :recide.serialized-throwable/v2
    :serializer recide.utils/serialize-throwable
    :constructor clojure.core/ex-info
    :metadata-fns {}})
</code></pre></div></div></div><div class="public anchor" id="var-error-map"><h3>error-map</h3><div class="usage"><code>(error-map type msg data)</code><code>(error-map type msg data cause)</code></div><div class="doc"><div class="markdown"><p>Returns a map representing a recide error with the type (keyword), msg (string), data map, and cause.</p>
<p>{recide.impl/default-error-definition type,  :recide/type msg,  :recide/msg data,  :recide/data cause,  :recide/cause <serialized-form>}</serialized-form></p>
<p>ErrorForm definition: :recide.serialized-throwable/v1 Constructor: clojure.core$ex_info</p></div></div></div><div class="public anchor" id="var-error-map-.3Eform"><h3>error-map-&gt;form</h3><div class="usage"><code>(error-map-&gt;form x)</code></div><div class="doc"><div class="markdown"><p>If x is a recide error-map, returns the ErrorForm defining its construction.</p></div></div></div><div class="public anchor" id="var-error-map-.3Ethrowable"><h3>error-map-&gt;throwable</h3><div class="usage"><code>(error-map-&gt;throwable err)</code></div><div class="doc"><div class="markdown"><p>Verifies that the map is polymorphic to a recide error, then converts it back into an IExceptionInfo. It will use the ErrorForm (and constructor) designated in the map by :recide/error.</p></div></div></div><div class="public anchor" id="var-error-map.3F"><h3>error-map?</h3><div class="usage"><code>(error-map? x)</code><code>(error-map? x type)</code></div><div class="doc"><div class="markdown"><p>Checks whether the given map constitutes a valid recide error. If a keyword type is provided, this also verifies that the error is of that type. Matches :namespace/* as a partial wildcard for error types.</p></div></div></div><div class="public anchor" id="var-error-type"><h3>error-type</h3><div class="usage"><code>(error-type x)</code></div><div class="doc"><div class="markdown"><p>Accepts a recide error or error-map. Returns nil when it’s not. Not safe for use in a custom constructor unless serialization/deserialization is out of the question.</p></div></div></div><div class="public anchor" id="var-error.3F"><h3>error?</h3><div class="usage"><code>(error? x)</code><code>(error? x type)</code></div><div class="doc"><div class="markdown"><p>Checks whether the given IExceptionInfo is a recide error. If a type keyword is provided, it also checks that the error has that type.</p></div></div></div><div class="public anchor" id="var-generate-library.21"><h3>generate-library!</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-library! custom-error capture-flag)</code></div><div class="doc"><div class="markdown"><p>Generates and defs custom versions of the following recide.core methods, tailored specifically to custom-error, with variable capture in the generated <code>insist</code> subject to capture-flag.  * error  * error?  * error-map  * error-map?  * throwable-&gt;error-map  * raise  * insist  * deferror  * deferror-group</p>
<p>custom-error should be an instance of recide.error/ErrorForm (see <code>def-error-form</code>). capture-flag must be resolvable to a dynamic var.</p></div></div></div><div class="public anchor" id="var-insist"><h3>insist</h3><h4 class="type">macro</h4><div class="usage"><code>(insist expr)</code><code>(insist expr message)</code></div><div class="doc"><div class="markdown"><p>Same syntax as assert. If assertion is disabled, insistence will also be disabled. Throws an IExceptionInfo if expr does not evaluate to logical true. recide.impl/default-error-definition is the constructor used.</p>
<p>Otherwise, it acts like recide/raise, constructing a recide error of the following form: {:recide/type :recide/assertion,  :recide/msg msg,  :recide/data <data>,  :recide.serialized-throwable/v1 <serialized-form>}</serialized-form></data></p>
<p>When recide.impl/*capture-insists* is true, this will also capture the bindings of symbols used in the assertion, inserting these values into the data map. recide.impl/*capture-insists* is false by default, unless one of the following was true at class load:  (1) env var is true: RECIDERE_CAPTURE_INSISTS  (2) system property is set: recide.capture-insists</p></div></div></div><div class="public anchor" id="var-make-tag-.3Eerror-form"><h3>make-tag-&gt;error-form</h3><div class="usage"><code>(make-tag-&gt;error-form &amp; error-form)</code></div><div class="doc"><div class="markdown"><p>Utility function. Pass in the ErrorForms you care about, and this returns tag-&gt;error-form appropriate for use with deserialize-throwable.</p></div></div></div><div class="public anchor" id="var-raise"><h3>raise</h3><h4 class="type">macro</h4><div class="usage"><code>(raise type msg data)</code><code>(raise type msg data cause)</code></div><div class="doc"><div class="markdown"><p>Records this raise-site on the ErrorForm definition, and constructs an IExceptionInfo as a recide-style error.</p>
<p>ErrorForm: recide.impl/default-error-definition Constructor: clojure.core$ex_info</p>
<p>Merges the following map onto the data: {:recide/error recide.impl/default-error-definition,  :recide/type type}</p></div></div></div><div class="public anchor" id="var-throwable-.3Eerror-map"><h3>throwable-&gt;error-map</h3><div class="usage"><code>(throwable-&gt;error-map e)</code></div><div class="doc"><div class="markdown"><p>Takes an error-map, error, or any Throwable, and converts it to a recide error-map conforming to the ErrorForm:  - recide.impl/default-error-definition</p>
<p>The return map will be shaped like so:</p>
<p>{:recide/type <type>,  :recide/msg <msg>,  :recide/data <ex-data>,  :recide/cause <cause>,  :recide.serialized-throwable/v1 <serialized-form>}</serialized-form></cause></ex-data></msg></type></p></div></div></div><div class="public anchor" id="var-try*"><h3>try*</h3><h4 class="type">macro</h4><div class="usage"><code>(try* try* expr* catch-clause* finally-clause?)</code></div><div class="doc"><div class="markdown"><p>Expands to Clojure’s try Special Form, allowing for enhanced <code>catch</code> clauses: You can catch:  * Classes/Interfaces (represents an instance? check)  <code>(catch RuntimeException e ...)</code>  * keywords (recide error types; fully-qualified: :namspace/name, wildcard: :namespace/*)  <code>(catch :library/error e ...)</code>  * arbitrary predicates  <code>(catch bad-error? e ...)</code> You can also catch conjunctions/disjunctions of these:  * conjunction  <code>(catch :and [RuntimeException :library/error bad-error?] e ...)</code>  * disjunction  <code>(catch :or [IllegalArgumentException :library/error bad-error?] e ...)</code> You can also negate each of these:  <code>(catch (:not RuntimeException) e ...)</code>  <code>(catch :and [(:not RuntimeException) :library/*] e ...)</code> Otherwise, behavior should match ‘normal’ catch clauses in <code>clojure.core/try</code>.</p></div></div></div><div class="public anchor" id="var-update-error"><h3>update-error</h3><div class="usage"><code>(update-error x k f &amp; args)</code></div><div class="doc"><div class="markdown"><p>Given a recide error, this returns a copy with its ex-data modified as though with (apply update data f args).</p></div></div></div></div></body></html>