<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>recide.impl documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Recide</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>recide</span></div></div></li><li class="depth-2 branch"><a href="recide.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="recide.error.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error</span></div></a></li><li class="depth-2 branch"><a href="recide.fressian.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fressian</span></div></a></li><li class="depth-2 branch current"><a href="recide.impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></a></li><li class="depth-2"><a href="recide.sanex.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sanex</span></div></a></li><li class="depth-3"><a href="recide.sanex.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-2"><a href="recide.utils.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="recide.impl.html#var-*capture-insists*"><div class="inner"><span>*capture-insists*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-custom-error-map.3F"><div class="inner"><span>custom-error-map?</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-custom-error.3F"><div class="inner"><span>custom-error?</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-default-error-definition"><div class="inner"><span>default-error-definition</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-deferror*"><div class="inner"><span>deferror*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-deferror-group*"><div class="inner"><span>deferror-group*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error"><div class="inner"><span>error</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error*"><div class="inner"><span>error*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-.3Emap"><div class="inner"><span>error-&gt;map</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-.3Eserializable"><div class="inner"><span>error-&gt;serializable</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-map"><div class="inner"><span>error-map</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-map*"><div class="inner"><span>error-map*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-map-.3Eerror"><div class="inner"><span>error-map-&gt;error</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-map-.3Eserializable-error"><div class="inner"><span>error-map-&gt;serializable-error</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-map-.3Ethrowable"><div class="inner"><span>error-map-&gt;throwable</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-map.3F"><div class="inner"><span>error-map?</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error-type"><div class="inner"><span>error-type</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-error.3F"><div class="inner"><span>error?</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-custom-error-library"><div class="inner"><span>generate-custom-error-library</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-deferror"><div class="inner"><span>generate-deferror</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-deferror*"><div class="inner"><span>generate-deferror*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-deferror-group"><div class="inner"><span>generate-deferror-group</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-deferror-group*"><div class="inner"><span>generate-deferror-group*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error"><div class="inner"><span>generate-error</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error*"><div class="inner"><span>generate-error*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error-map"><div class="inner"><span>generate-error-map</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error-map*"><div class="inner"><span>generate-error-map*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error-map.3F"><div class="inner"><span>generate-error-map?</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error-map.3F*"><div class="inner"><span>generate-error-map?*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error.3F"><div class="inner"><span>generate-error?</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-error.3F*"><div class="inner"><span>generate-error?*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-insist"><div class="inner"><span>generate-insist</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-raise"><div class="inner"><span>generate-raise</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-raise*"><div class="inner"><span>generate-raise*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-throwable-.3Eerror-map"><div class="inner"><span>generate-throwable-&gt;error-map</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-generate-throwable-.3Eerror-map*"><div class="inner"><span>generate-throwable-&gt;error-map*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-insist"><div class="inner"><span>insist</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-insist*"><div class="inner"><span>insist*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-raise"><div class="inner"><span>raise</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-raise*"><div class="inner"><span>raise*</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-read-string-with-default-tagging"><div class="inner"><span>read-string-with-default-tagging</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-record-raised-error-site.21"><div class="inner"><span>record-raised-error-site!</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-throwable-.3Eerror-map"><div class="inner"><span>throwable-&gt;error-map</span></div></a></li><li class="depth-1"><a href="recide.impl.html#var-var-.3Equalified-sym"><div class="inner"><span>var-&gt;qualified-sym</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">recide.impl</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-*capture-insists*"><h3>*capture-insists*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">If true, default `insist` will capture the values of all lexical bindings
used within the clause.</pre></div></div><div class="public anchor" id="var-custom-error-map.3F"><h3>custom-error-map?</h3><div class="usage"><code>(custom-error-map? error-form x)</code><code>(custom-error-map? custom-error x type)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-custom-error.3F"><h3>custom-error?</h3><div class="usage"><code>(custom-error? custom-error x)</code><code>(custom-error? custom-error x type)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-default-error-definition"><h3>default-error-definition</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-deferror*"><h3>deferror*</h3><h4 class="type">macro</h4><div class="usage"><code>(deferror* custom-error error-name type generic-str)</code><code>(deferror* custom-error error-name type generic-str required-keys)</code></div><div class="doc"><pre class="plaintext">Defines a new error constructor and a specialized version of the recide/raise macro,
where the type and the 'generic' portion of the error message are static and required
arguments are specified via the final sequence of key-words. Defines two macros (for
compile-time errors). The first is a constructor named error-name, with the signature:
([detail-msg data] [detail-msg data cause])

Also defined is a corresponding `raise-` macro with the signature:
([detail-msg {:as extra-data}]
 [detail-msg {:as extra-data} cause]).

Example:
(deferror storage-timeout
    :storage/timeout
    "A storage operation timed out"
    [:method])

You can use the constructor like so:
(storage-timeout "A call to get-value took too long."
                 {:method 'get-value,
                  :nodes-count (count kvs)})

This macro would expand into the following:
(error :storage/timeout
       (str "A storage operation timed out: "
            "A call to get-value took too long.")
       {:method 'get-value,
        :nodes-count (count kvs)})

Using the generated raise- macro is similar:
(raise-storage-timeout "A call to get-value took too long."
                       {:method 'get-value
                        :nodes-count (count kvs)})

This macro would expand similarly into a raise form. In both examples, if :method were left
out of the data map, an exception would be thrown at compile time.</pre></div></div><div class="public anchor" id="var-deferror-group*"><h3>deferror-group*</h3><h4 class="type">macro</h4><div class="usage"><code>(deferror-group* custom-error error-name group-key subtypes)</code></div><div class="doc"><pre class="plaintext">Defines specialized (macro) variants of recide/error and recide/raise, for working
with a namespaced family of error types. For each subtype, the 'generic' portion of the
error message is static. Required data keywords can be specified for both the entire
family of errors and for each subtype.

Both the constructor and raise macros have the same signature:
([subtype detail-msg {:as extra-data}]
 [subtype detail-msg {:as extra-data} cause]).

Example:
(deferror-group parse-err
    (:query.invalid [:expression])
    (find-spec "Invalid find spec")
    (inputs "Invalid inputs" [:invalid]))

An example of using the constructor is:
(parse-err :inputs
           "Input arguments must be integers"
           {:expression spec,
            :invalid (remove input? args)})

This would expand into the following:
(error :query.invalid/inputs
       (str "Invalid inputs"
            ":"
            "Input arguments must be integers"
       {:expresion spec, :invalid (remove input? args)})

To use the raise form, you would replace `parse-err` with `raise-parse-err`. In either case
in this example, if either :expression or :invalid were left out of the data map, an
exception would be thrown at compile time.</pre></div></div><div class="public anchor" id="var-error"><h3>error</h3><div class="usage"><code>(error type msg data)</code><code>(error type msg data cause)</code></div><div class="doc"><pre class="plaintext">Returns a recide error (IExceptionInfo) with the type (keyword), msg (string), data (map),
and cause (Throwable). Merges the following map onto the ex-data:

{:recide/error recide.error.ErrorForm@7be94cd6,
 :recide/type type}

ErrorForm definition: recide.impl/default-error-definition
Constructor: clojure.core$ex_info</pre></div></div><div class="public anchor" id="var-error*"><h3>error*</h3><div class="usage"><code>(error* custom-error type msg data)</code><code>(error* custom-error type msg data cause)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-error-.3Emap"><h3>error-&gt;map</h3><div class="usage"><code>(error-&gt;map x)</code></div><div class="doc"><pre class="plaintext">Verifies that the IExceptionInfo is a recide error, then converts it to map form.
</pre></div></div><div class="public anchor" id="var-error-.3Eserializable"><h3>error-&gt;serializable</h3><div class="usage"><code>(error-&gt;serializable err)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-error-map"><h3>error-map</h3><div class="usage"><code>(error-map type msg data)</code><code>(error-map type msg data cause)</code></div><div class="doc"><pre class="plaintext">Returns a map representing a recide error with the type (keyword), msg (string), data map,
and cause.

{recide.impl/default-error-definition type,
 :recide/type msg,
 :recide/msg data,
 :recide/data cause,
 :recide/cause &lt;serialized-form&gt;}

ErrorForm definition: :recide.serialized-throwable/v1
Constructor: clojure.core$ex_info</pre></div></div><div class="public anchor" id="var-error-map*"><h3>error-map*</h3><div class="usage"><code>(error-map* custom-error type msg data)</code><code>(error-map* custom-error type msg data cause)</code></div><div class="doc"><pre class="plaintext">Creates the map form of a recide error with the type (keyword), msg (string), data map, and cause.
</pre></div></div><div class="public anchor" id="var-error-map-.3Eerror"><h3>error-map-&gt;error</h3><div class="usage"><code>(error-map-&gt;error err)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-error-map-.3Eserializable-error"><h3>error-map-&gt;serializable-error</h3><div class="usage"><code>(error-map-&gt;serializable-error err)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-error-map-.3Ethrowable"><h3>error-map-&gt;throwable</h3><div class="usage"><code>(error-map-&gt;throwable err)</code></div><div class="doc"><pre class="plaintext">Verifies that the map is polymorphic to a recide error, then converts it back into an IExceptionInfo.
It will use the ErrorForm (and constructor) designated in the map by :recide/error.</pre></div></div><div class="public anchor" id="var-error-map.3F"><h3>error-map?</h3><div class="usage"><code>(error-map? x)</code><code>(error-map? x type)</code></div><div class="doc"><pre class="plaintext">Checks whether the given map constitutes a valid recide error. If a
keyword type is provided, this also verifies that the error is of that type.
Matches :namespace/* as a partial wildcard for error types.</pre></div></div><div class="public anchor" id="var-error-type"><h3>error-type</h3><div class="usage"><code>(error-type x)</code></div><div class="doc"><pre class="plaintext">Accepts a recide error or error-map. Returns nil when it's not. Not safe for use in
a custom constructor unless serialization/deserialization is out of the question.</pre></div></div><div class="public anchor" id="var-error.3F"><h3>error?</h3><div class="usage"><code>(error? x)</code><code>(error? x type)</code></div><div class="doc"><pre class="plaintext">Checks whether the given IExceptionInfo is a recide error.
If a type keyword is provided, it also checks that the error has that type.</pre></div></div><div class="public anchor" id="var-generate-custom-error-library"><h3>generate-custom-error-library</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-custom-error-library custom-error capture-flag)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-deferror"><h3>generate-deferror</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-deferror custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-deferror*"><h3>generate-deferror*</h3><div class="usage"><code>(generate-deferror* custom-error)</code></div><div class="doc"><pre class="plaintext">custom-error is fully-qualified symbol.
</pre></div></div><div class="public anchor" id="var-generate-deferror-group"><h3>generate-deferror-group</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-deferror-group custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-deferror-group*"><h3>generate-deferror-group*</h3><div class="usage"><code>(generate-deferror-group* custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error"><h3>generate-error</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-error custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error*"><h3>generate-error*</h3><div class="usage"><code>(generate-error* custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error-map"><h3>generate-error-map</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-error-map custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error-map*"><h3>generate-error-map*</h3><div class="usage"><code>(generate-error-map* custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error-map.3F"><h3>generate-error-map?</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-error-map? custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error-map.3F*"><h3>generate-error-map?*</h3><div class="usage"><code>(generate-error-map?* custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error.3F"><h3>generate-error?</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-error? custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-error.3F*"><h3>generate-error?*</h3><div class="usage"><code>(generate-error?* custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-insist"><h3>generate-insist</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-insist capture-flag custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-raise"><h3>generate-raise</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-raise custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-raise*"><h3>generate-raise*</h3><div class="usage"><code>(generate-raise* custom-error)</code></div><div class="doc"><pre class="plaintext">custom-error must be fully-qualified symbols.
</pre></div></div><div class="public anchor" id="var-generate-throwable-.3Eerror-map"><h3>generate-throwable-&gt;error-map</h3><h4 class="type">macro</h4><div class="usage"><code>(generate-throwable-&gt;error-map custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-generate-throwable-.3Eerror-map*"><h3>generate-throwable-&gt;error-map*</h3><div class="usage"><code>(generate-throwable-&gt;error-map* custom-error)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-insist"><h3>insist</h3><h4 class="type">macro</h4><div class="usage"><code>(insist expr)</code><code>(insist expr message)</code></div><div class="doc"><pre class="plaintext">Same syntax as assert. If assertion is disabled, insistence will also be disabled.
Throws an IExceptionInfo if expr does not evaluate to logical true.
recide.impl/default-error-definition is the constructor used.

Otherwise, it acts like recide/raise, constructing a recide error of
the following form:
{:recide/type :recide/assertion,
 :recide/msg msg,
 :recide/data &lt;data&gt;,
 :recide.serialized-throwable/v1 &lt;serialized-form&gt;}

When recide.impl/*capture-insists* is true, this will also capture the bindings of symbols used
in the assertion, inserting these values into the data map. recide.impl/*capture-insists*
is false by default, unless one of the following was true at class load:
 (1) env var is true: RECIDERE_CAPTURE_INSISTS
 (2) system property is set: recide.capture-insists</pre></div></div><div class="public anchor" id="var-insist*"><h3>insist*</h3><h4 class="type">macro</h4><div class="usage"><code>(insist* capture-flag custom-error expr)</code><code>(insist* capture-flag custom-error expr message)</code></div><div class="doc"><pre class="plaintext">capture-flag, raised-sites, and custom-error must be fully-qualified symbols.
Same syntax as assert. If assertion is disabled, insistence will also be disabled.
Throws an exception if expr does not evaluate to logical true.

Otherwise, it acts like recide/raise, with type :recide/assertion. The bindings of
symbols used in the assertion are inserted into the info map.</pre></div></div><div class="public anchor" id="var-raise"><h3>raise</h3><h4 class="type">macro</h4><div class="usage"><code>(raise type msg data)</code><code>(raise type msg data cause)</code></div><div class="doc"><pre class="plaintext">Records this raise-site on the ErrorForm definition, and constructs
an IExceptionInfo as a recide-style error.

ErrorForm: recide.impl/default-error-definition
Constructor: clojure.core$ex_info

Merges the following map onto the data:
{:recide/error recide.impl/default-error-definition,
 :recide/type type}</pre></div></div><div class="public anchor" id="var-raise*"><h3>raise*</h3><h4 class="type">macro</h4><div class="usage"><code>(raise* custom-error type msg data)</code><code>(raise* custom-error type msg data cause)</code></div><div class="doc"><pre class="plaintext">raised-sites and custom-error are fully-qualified symbols
Records this raise-site for the error type, and expands into:

(throw (error {:recide/type type,
               :recide/msg msg,
               :recide/data data,
               :recide/cause cause}))</pre></div></div><div class="public anchor" id="var-read-string-with-default-tagging"><h3>read-string-with-default-tagging</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-record-raised-error-site.21"><h3>record-raised-error-site!</h3><div class="usage"><code>(record-raised-error-site! custom-error err-type msg ns form)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-throwable-.3Eerror-map"><h3>throwable-&gt;error-map</h3><div class="usage"><code>(throwable-&gt;error-map custom-error e)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-var-.3Equalified-sym"><h3>var-&gt;qualified-sym</h3><div class="usage"><code>(var-&gt;qualified-sym v)</code></div><div class="doc"><pre class="plaintext"></pre></div></div></div></body></html>